# ğŸ¯ DataSave Ù…Ø±Ø­Ù„Ù‡ Ûµ.Û²: Form Builder UI Engine
## Ù†Ø³Ø®Ù‡ Ø³Ø®ØªÚ¯ÛŒØ±Ø§Ù†Ù‡ Ùˆ Ù‚Ø§Ù†ÙˆÙ†Ù…Ù†Ø¯ - STRICT MODE UI ENGINE

---

## ğŸš¨ **Ù‚ÙˆØ§Ù†ÛŒÙ† Ù…Ø·Ù„Ù‚ Ù¾Ø±Ø§Ù…Ù¾Øª - NON-NEGOTIABLE RULES**

### â›” **STOP! Ú©Ø§Ù…Ù„Ø§Ù‹ Ù…Ù…Ù†ÙˆØ¹:**
```yaml
âŒ Ù‡ÛŒÚ† ØªØºÛŒÛŒØ±ÛŒ Ø¯Ø± Database Schema (Ù…Ø±Ø­Ù„Ù‡ 5.1 Ú©Ø§Ù…Ù„ Ø§Ø³Øª)
âŒ Ù‡ÛŒÚ† ØªØºÛŒÛŒØ±ÛŒ Ø¯Ø± Backend PHP Classes Ù…ÙˆØ¬ÙˆØ¯
âŒ Ù‡ÛŒÚ† modification Ø¯Ø± API endpoints ÙØ¹Ù„ÛŒ 
âŒ Ù‡ÛŒÚ† package Ø§Ø¶Ø§ÙÛŒ Ø¨Ø¯ÙˆÙ† ØªØ£ÛŒÛŒØ¯ ØµØ±ÛŒØ­
âŒ ØªØºÛŒÛŒØ± Ø¯Ø± Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ Ùˆ Ù…Ø³ÛŒØ±Ù‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯
âŒ Ù¾ÛŒØ´ Ø§Ø² Ø¯Ø±ÛŒØ§ÙØª ØªØ£ÛŒÛŒØ¯ØŒ Ù‡ÛŒÚ† Ø¹Ù…Ù„ Ø§Ø¬Ø±Ø§ÛŒÛŒ Ø§Ù†Ø¬Ø§Ù… Ù†Ø¯Ù‡ÛŒØ¯
âŒ ØªØºÛŒÛŒØ± Ø¯Ø± theme Ùˆ typography Ù…ÙˆØ¬ÙˆØ¯
âŒ Ø´Ú©Ø³ØªÙ† Clean Architecture patterns Ù…ÙˆØ¬ÙˆØ¯
```

### âœ… **ÙÙ‚Ø· Ù…Ø¬Ø§Ø² Ø¨Ù‡:**
```yaml
âœ… Ø§ÛŒØ¬Ø§Ø¯ Flutter UI components Ø¬Ø¯ÛŒØ¯
âœ… Ø§ÙØ²ÙˆØ¯Ù† ØµÙØ­Ø§Øª Form Builder 
âœ… Integration Ø¨Ø§ PHP APIs Ù…ÙˆØ¬ÙˆØ¯
âœ… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Provider state management
âœ… Ø±Ø¹Ø§ÛŒØª Persian RTL standards Ù…ÙˆØ¬ÙˆØ¯
âœ… Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ UI components
âœ… ØªÙˆØ³Ø¹Ù‡ Widget Library Ø¨Ø±Ø§ÛŒ form builder
âœ… Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Drag & Drop interface
```

---

## ğŸ“‹ **Ù…Ø£Ù…ÙˆØ±ÛŒØª Ø¯Ù‚ÛŒÙ‚ Ù…Ø±Ø­Ù„Ù‡ Ûµ.Û²**

### ğŸ¯ Ù‡Ø¯Ù Ù…Ù†Ø­ØµØ±Ø§Ù‹:
**Ø·Ø±Ø§Ø­ÛŒ Ùˆ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Form Builder UI Engine Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² foundation Ù…Ø±Ø­Ù„Ù‡ Ûµ.Û±**

### ğŸ—ºï¸ **Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ûµ - ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ:**
```yaml
Phase 5.1: Database Evolution & Schema        â† âœ… ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡
Phase 5.2: Form Builder UI Engine            â† ğŸ¯ Ø´Ù…Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù‡Ø³ØªÛŒØ¯  
Phase 5.3: AI Integration Engine (Ø¢ÛŒÙ†Ø¯Ù‡)
Phase 5.4: Analytics & Optimization (Ø¢ÛŒÙ†Ø¯Ù‡)

âš ï¸ ØªØ°Ú©Ø±: ÙÙ‚Ø· Ø±ÙˆÛŒ 5.2 Ú©Ø§Ø± Ú©Ù†ÛŒØ¯. Ø³Ø§ÛŒØ± Ù…Ø±Ø§Ø­Ù„ ÙÙ‚Ø· Context!
```

---

## ğŸ“Š **Context Ú©Ø§Ù…Ù„ - Ù…Ø±Ø­Ù„Ù‡ Ûµ.Û± ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡**

### âœ… **Database Schema Ø¢Ù…Ø§Ø¯Ù‡ (Ø¯Ø³Øª Ù†Ø²Ù†ÛŒØ¯):**
```sql
-- Ø¬Ø¯Ø§ÙˆÙ„ Ø¹Ù…Ù„ÛŒØ§ØªÛŒ Ù…Ø±Ø­Ù„Ù‡ 5.1
users (2 records):
  - admin@datasave.ir (admin role)
  - test@datasave.ir (user role)
  - bcrypt password hashing âœ…
  - Persian name support âœ…

forms (1 sample):
  - persian_title: "ÙØ±Ù… ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§"
  - JSON schema support âœ…
  - user ownership âœ…
  - status management âœ…

form_widgets (10 widgets):
  - text, textarea, number, email, select
  - radio, checkbox, date, time, submit
  - Persian labels âœ…
  - JSON configuration âœ…

form_responses (ready):
  - response collection system âœ…
  - IP tracking âœ…
  - JSON data storage âœ…

-- Views Ùˆ Triggers ÙØ¹Ø§Ù„:
v_user_forms_stats, v_popular_widgets, v_recent_responses
trg_response_insert_stats, trg_response_delete_stats, trg_form_create_widget_stats
```

### âœ… **PHP Backend Ø¢Ù…Ø§Ø¯Ù‡ (Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯):**
```php
Classes Available:
- backend/classes/User.php        â† Authentication + CRUD
- backend/classes/Form.php        â† Form management + publishing
- backend/classes/FormWidget.php  â† Widget library management
- backend/classes/FormResponse.php â† Response collection

API Endpoints Ù…ÙˆØ¬ÙˆØ¯ (Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯):
- GET/POST /api/settings/*        â† ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³ÛŒØ³ØªÙ…
- POST /api/logs/*                â† Ù„Ø§Ú¯ÛŒÙ†Ú¯ Ø³ÛŒØ³ØªÙ…
- GET /api/system/*               â† ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…

âš ï¸ Ù†ÛŒØ§Ø² Ø¨Ù‡ API endpoints Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Form Builder
```

### âœ… **Flutter Foundation Ù…ÙˆØ¬ÙˆØ¯ (Ú¯Ø³ØªØ±Ø´ Ø¯Ù‡ÛŒØ¯):**
```yaml
Current Structure:
lib/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ config/app_config.dart          â† Config management âœ…
â”‚   â”œâ”€â”€ constants/app_constants.dart    â† Constants âœ… 
â”‚   â”œâ”€â”€ theme/app_theme.dart           â† Material Design 3 + Vazirmatn âœ…
â”‚   â””â”€â”€ utils/validators.dart          â† Validation utilities âœ…
â”œâ”€â”€ presentation/
â”‚   â”œâ”€â”€ pages/home/home_page.dart      â† Dashboard Ù…ÙˆØ¬ÙˆØ¯ âœ…
â”‚   â””â”€â”€ routes/app_routes.dart         â† Navigation âœ…
â””â”€â”€ main.dart                          â† Entry point âœ…

Current Features:
- Persian RTL Support âœ…
- Material Design 3 Theme âœ…  
- Vazirmatn Font Integration âœ…
- Provider State Management âœ…
- Responsive Design Foundation âœ…
```

---

## ğŸ¯ **Requirements Ø³Ø®ØªÚ¯ÛŒØ±Ø§Ù†Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ûµ.Û²**

### **Û±. Form Builder Core Interface (Ø§Ø¬Ø¨Ø§Ø±ÛŒ):**

#### **ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ Form Builder:**
```yaml
Location: lib/presentation/pages/form_builder/
Required Components:
  - form_builder_page.dart (ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ)
  - widgets_library_panel.dart (Ù¾Ù†Ù„ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ ÙˆÛŒØ¬Øªâ€ŒÙ‡Ø§)
  - form_canvas.dart (Ø¨ÙˆÙ… Ø·Ø±Ø§Ø­ÛŒ ÙØ±Ù…)
  - form_preview_panel.dart (Ù¾Ù†Ù„ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´)
  - properties_panel.dart (Ù¾Ù†Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙˆÛŒØ¬Øª)

Persian Features:
  - ØªÙ…Ø§Ù… Ù…ØªÙ†â€ŒÙ‡Ø§ ÙØ§Ø±Ø³ÛŒ
  - RTL layout Ú©Ø§Ù…Ù„
  - Ø±Ø§Ø³Øªâ€ŒÚ†ÛŒÙ† Ú©Ø±Ø¯Ù† Ù¾Ù†Ù„â€ŒÙ‡Ø§
  - ÙÙˆÙ†Øª Vazirmatn
  - Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®Ø·Ø§ ÙØ§Ø±Ø³ÛŒ

UI Requirements:
  - Material Design 3 consistency
  - Mobile-first responsive
  - Accessibility support
  - Loading states
  - Error handling UI
```

#### **Widget Library System:**
```yaml
Integration Ø¨Ø§ form_widgets table:
  - Ø¯Ø±ÛŒØ§ÙØª 10 ÙˆÛŒØ¬Øª Ù¾Ø§ÛŒÙ‡ Ø§Ø² database
  - Ù†Ù…Ø§ÛŒØ´ ÙˆÛŒØ¬Øªâ€ŒÙ‡Ø§ Ø¨Ø§ Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ
  - Drag & Drop functionality
  - Icon display Ø¨Ø±Ø§ÛŒ Ù‡Ø± ÙˆÛŒØ¬Øª
  - Category grouping (text, selection, date, etc)

Widget Types Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ:
  text: Ú©Ø§Ø¯Ø± Ù…ØªÙ† Ø³Ø§Ø¯Ù‡
  textarea: Ú©Ø§Ø¯Ø± Ù…ØªÙ† Ú†Ù†Ø¯Ø®Ø·  
  number: ÙˆØ±ÙˆØ¯ÛŒ Ø¹Ø¯Ø¯ÛŒ
  email: ÙˆØ±ÙˆØ¯ÛŒ Ø§ÛŒÙ…ÛŒÙ„
  select: Ù„ÛŒØ³Øª Ú©Ø´ÙˆÛŒÛŒ
  radio: Ø¯Ú©Ù…Ù‡ Ø±Ø§Ø¯ÛŒÙˆÛŒÛŒ
  checkbox: Ú†Ú©â€ŒØ¨Ø§Ú©Ø³
  date: Ø§Ù†ØªØ®Ø§Ø¨ ØªØ§Ø±ÛŒØ®
  time: Ø§Ù†ØªØ®Ø§Ø¨ Ø²Ù…Ø§Ù†
  submit: Ø¯Ú©Ù…Ù‡ Ø§Ø±Ø³Ø§Ù„
```

#### **Drag & Drop Form Designer:**
```yaml
Canvas Requirements:
  - Drop zone Ù…Ø´Ø®Øµ Ø¨Ø§ visual indicators
  - Widget positioning system
  - Grid system Ø¨Ø±Ø§ÛŒ alignment
  - Multi-select ÙˆÛŒØ¬Øªâ€ŒÙ‡Ø§
  - Copy/Paste/Delete operations
  - Undo/Redo functionality (basic)

Drag & Drop Features:
  - Widget dragging Ø§Ø² library Ø¨Ù‡ canvas
  - Reordering ÙˆÛŒØ¬Øªâ€ŒÙ‡Ø§ Ø¯Ø± canvas
  - Visual feedback Ù‡Ù†Ú¯Ø§Ù… drag
  - Snap to grid functionality
  - Persian tooltips Ùˆ guides

Persian RTL Considerations:
  - Canvas layout Ø±Ø§Ø³Øªâ€ŒÚ†ÛŒÙ†
  - Widget positioning RTL-aware
  - Property panels Ø¯Ø± Ø³Ù…Øª Ú†Ù¾
  - Form preview Ø¯Ø± Ø¬Ù‡Øª ØµØ­ÛŒØ­
```

### **Û². API Integration Layer (Ø¶Ø±ÙˆØ±ÛŒ):**

#### **Ù†ÛŒØ§Ø² Ø¨Ù‡ API Endpoints Ø¬Ø¯ÛŒØ¯:**
```php
Required New APIs:
POST /api/forms/create.php
  - Ø§ÛŒØ¬Ø§Ø¯ ÙØ±Ù… Ø¬Ø¯ÛŒØ¯
  - Ø°Ø®ÛŒØ±Ù‡ JSON schema
  - User ownership validation

GET /api/forms/user_forms.php  
  - Ø¯Ø±ÛŒØ§ÙØª ÙØ±Ù…â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±
  - Pagination support
  - Status filtering

PUT /api/forms/update.php
  - Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙØ±Ù… Ù…ÙˆØ¬ÙˆØ¯
  - Version control
  - Schema validation

GET /api/widgets/library.php
  - Ø¯Ø±ÛŒØ§ÙØª Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ ÙˆÛŒØ¬Øªâ€ŒÙ‡Ø§
  - Category filtering
  - Persian label support

DELETE /api/forms/delete.php
  - Ø­Ø°Ù ÙØ±Ù… (soft delete)
  - Cascade considerations
  - Permission checking
```

#### **Flutter API Service Layer:**
```yaml
Location: lib/core/services/
Required Services:
  - form_api_service.dart (Form CRUD operations)
  - widget_api_service.dart (Widget library access)
  - user_service.dart (User management - future)

Integration Pattern:
  - Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Dio package Ù…ÙˆØ¬ÙˆØ¯
  - Error handling Ù…Ø·Ø§Ø¨Ù‚ patterns Ù…ÙˆØ¬ÙˆØ¯
  - Provider state management
  - Response caching Ø¨Ø±Ø§ÛŒ widgets
  - Persian error messages

Service Methods:
  - Future<List<Form>> getUserForms(int userId)
  - Future<Form> createForm(Form formData)
  - Future<Form> updateForm(int formId, Form formData)
  - Future<List<Widget>> getWidgetLibrary()
  - Future<bool> deleteForm(int formId)
```

### **Û³. State Management Architecture (Ø§Ù„Ø²Ø§Ù…ÛŒ):**

#### **Provider Classes Ø¬Ø¯ÛŒØ¯:**
```yaml
Location: lib/core/providers/
Required Providers:
  - form_builder_provider.dart (Ø­Ø§Ù„Øª Form Builder)
  - widget_library_provider.dart (Ù…Ø¯ÛŒØ±ÛŒØª Widget Library)
  - form_list_provider.dart (Ù„ÛŒØ³Øª ÙØ±Ù…â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±)
  - canvas_provider.dart (ÙˆØ¶Ø¹ÛŒØª Canvas)

FormBuilderProvider Features:
  - currentForm: Form? (ÙØ±Ù… Ø¯Ø± Ø­Ø§Ù„ ÙˆÛŒØ±Ø§ÛŒØ´)
  - selectedWidget: FormWidget? (ÙˆÛŒØ¬Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡)
  - canvasWidgets: List<FormWidget> (ÙˆÛŒØ¬Øªâ€ŒÙ‡Ø§ÛŒ Ø±ÙˆÛŒ canvas)
  - isPreviewMode: bool (Ø­Ø§Ù„Øª Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´)
  - formSchema: Map<String, dynamic> (JSON schema)

State Management Methods:
  - addWidgetToCanvas(FormWidget widget)
  - removeWidgetFromCanvas(String widgetId)  
  - updateWidgetProperties(String widgetId, Map properties)
  - selectWidget(String widgetId)
  - togglePreviewMode()
  - saveForm()
  - loadForm(int formId)
```

#### **Error Handling State:**
```yaml
Error Provider Integration:
  - Persian error messages
  - User-friendly error display
  - Retry mechanisms
  - Offline state handling
  - Network connectivity awareness

Loading States:
  - Form loading indicators
  - Widget library loading
  - Save operation feedback
  - Real-time validation states
```

### **Û´. UI/UX Implementation (Ø¯Ù‚ÛŒÙ‚):**

#### **Navigation Integration:**
```yaml
Route Updates Ø¯Ø± app_routes.dart:
  '/form-builder': Form Builder main page
  '/form-builder/new': New form creation
  '/form-builder/edit/{id}': Edit existing form
  '/form-library': Form library/templates
  '/form-preview/{id}': Form preview mode

Bottom Navigation Enhancement:
  - Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† tab Ø¨Ø±Ø§ÛŒ Form Builder
  - Icon: Icons.build_rounded
  - Label: "ÙØ±Ù…â€ŒØ³Ø§Ø²"
  - Integration Ø¨Ø§ home_page.dart

Drawer Menu Updates:
  - "ÙØ±Ù…â€ŒÙ‡Ø§ÛŒ Ù…Ù†" menu item
  - "Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ ÙˆÛŒØ¬Øªâ€ŒÙ‡Ø§" menu item
  - "Ù‚Ø§Ù„Ø¨â€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡" (future)
```

#### **Responsive Design Requirements:**
```yaml
Mobile (< 768px):
  - Single panel view
  - Bottom sheet Ø¨Ø±Ø§ÛŒ properties  
  - Simplified widget library
  - Touch-optimized drag & drop
  - Persian keyboard support

Tablet (768-1024px):
  - Two panel layout
  - Widget library + canvas visible
  - Collapsible properties panel
  - Enhanced touch interactions

Desktop (> 1024px):
  - Three panel layout
  - Widget library | Canvas | Properties
  - Full drag & drop experience
  - Keyboard shortcuts support
  - Context menus
```

#### **Persian RTL Excellence:**
```yaml
Typography:
  - Vazirmatn font Ø¯Ø± ØªÙ…Ø§Ù… texts
  - ØµØ­ÛŒØ­ sizing Ø¨Ø±Ø§ÛŒ Persian characters
  - Line height optimization
  - Letter spacing Ù…Ù†Ø§Ø³Ø¨

Layout:
  - Canvas alignment RTL
  - Panel positioning Ø±Ø§Ø³Øªâ€ŒÚ†ÛŒÙ†
  - Button placement Ù…Ù†Ø§Ø³Ø¨
  - Icon direction awareness
  - Text field alignment

Content:
  - ØªÙ…Ø§Ù… labels Ùˆ instructions ÙØ§Ø±Ø³ÛŒ
  - Error messages Persian
  - Tooltips Ùˆ help texts ÙØ§Ø±Ø³ÛŒ  
  - Placeholder texts Ù…Ù†Ø§Ø³Ø¨
  - Success messages Persian
```

---

## ğŸ—ï¸ **Architecture Integration (Ø§Ø¬Ø¨Ø§Ø±ÛŒ)**

### **Clean Architecture Compliance:**
```yaml
Presentation Layer:
  - Pages Ø¯Ø± presentation/pages/form_builder/
  - Widgets Ø¯Ø± presentation/widgets/form_builder/
  - Provider classes Ø¨Ø±Ø§ÛŒ state management
  - Route definitions Ø¯Ø± app_routes.dart

Core Layer Integration:
  - Services Ø¯Ø± core/services/
  - Utils Ø¯Ø± core/utils/ 
  - Constants Ø¯Ø± core/constants/
  - Theme consistency Ø¯Ø± core/theme/

Code Organization:
  - Ù‡Ø± component Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ file
  - Persian comments Ø¨Ø±Ø§ÛŒ business logic
  - Error handling mØ·Ø§Ø¨Ù‚ patterns Ù…ÙˆØ¬ÙˆØ¯
  - Testing readiness (basic structure)
```

### **Performance Requirements:**
```yaml
UI Performance:
  - 60 FPS drag & drop operations
  - Smooth animations Ùˆ transitions
  - Lazy loading Ø¨Ø±Ø§ÛŒ widget library
  - Efficient canvas rendering
  - Memory management Ø¨Ø±Ø§ÛŒ large forms

API Performance:
  - Response caching Ø¨Ø±Ø§ÛŒ widgets
  - Debounced save operations
  - Optimistic UI updates
  - Background sync capabilities
  - Error recovery mechanisms

Bundle Size:
  - Ø­Ø¯Ø§Ú©Ø«Ø± +2MB increase
  - Tree-shaking optimization
  - Asset optimization
  - Code splitting considerations
```

---

## ğŸ“ **Security & Validation (ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ù…Ø°Ø§Ú©Ø±Ù‡)**

### **Client-Side Validation:**
```yaml
Form Validation:
  - Required field validation
  - Persian text validation
  - Email format validation (Persian-aware)
  - Number range validation
  - JSON schema validation

Widget Configuration:
  - Property type checking
  - Value range validation
  - Persian character support
  - XSS prevention Ø¯Ø± text fields
  - Safe JSON parsing
```

### **API Security Integration:**
```yaml
Authentication:
  - User session validation (prepare for future)
  - Form ownership verification  
  - Permission checking
  - CSRF protection awareness

Data Validation:
  - Server-side validation Ù…Ø·Ø§Ø¨Ù‚Øª
  - SQL injection prevention
  - Input sanitization
  - JSON schema validation
  - Persian encoding safety
```

---

## ğŸ› ï¸ **Deliverables Ù…ÙˆØ±Ø¯ Ø§Ù†ØªØ¸Ø§Ø± (Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ù‡Ù…ÛŒÙ†â€ŒÙ‡Ø§)**

### **Û±. Flutter UI Components (Ø§Ø¬Ø¨Ø§Ø±ÛŒ):**
```yaml
Core Pages:
1. lib/presentation/pages/form_builder/form_builder_page.dart
2. lib/presentation/pages/form_builder/form_list_page.dart
3. lib/presentation/pages/form_builder/form_preview_page.dart

Widget Components:
4. lib/presentation/widgets/form_builder/widget_library_panel.dart
5. lib/presentation/widgets/form_builder/form_canvas.dart
6. lib/presentation/widgets/form_builder/properties_panel.dart
7. lib/presentation/widgets/form_builder/draggable_widget.dart
8. lib/presentation/widgets/form_builder/form_preview.dart

State Management:
9. lib/core/providers/form_builder_provider.dart
10. lib/core/providers/widget_library_provider.dart
11. lib/core/providers/form_list_provider.dart

Services:
12. lib/core/services/form_api_service.dart
13. lib/core/services/widget_api_service.dart
```

### **Û². PHP API Endpoints (Ø¶Ø±ÙˆØ±ÛŒ):**
```yaml
New API Files:
1. backend/api/forms/create.php
2. backend/api/forms/user_forms.php
3. backend/api/forms/update.php
4. backend/api/forms/delete.php
5. backend/api/widgets/library.php

Integration:
- Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² classes Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± backend/classes/
- Error handling Ù…Ø·Ø§Ø¨Ù‚ patterns Ù…ÙˆØ¬ÙˆØ¯
- CORS configuration consistency  
- JSON response format Ù…Ø·Ø§Ø¨Ù‚Øª
- Persian error messages
```

### **Û³. Navigation & Routing:**
```yaml
Updates Required:
1. lib/presentation/routes/app_routes.dart
   - Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† routes Ø¬Ø¯ÛŒØ¯
   - Parameter handling Ø¨Ø±Ø§ÛŒ form editing

2. lib/presentation/pages/home/home_page.dart
   - Bottom navigation update
   - Dashboard statistics update
   - Form Builder entry point

3. Persian Navigation Labels:
   - "ÙØ±Ù…â€ŒØ³Ø§Ø²" for Form Builder
   - "ÙØ±Ù…â€ŒÙ‡Ø§ÛŒ Ù…Ù†" for My Forms
   - "Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´" for Preview
```

### **Û´. Documentation Updates:**
```yaml
New Documentation Folder: docs/08-Form-Builder/
Required Files:
1. form-builder-architecture.md
2. ui-components-reference.md  
3. drag-drop-implementation.md
4. widget-library-system.md
5. api-integration-guide.md
6. persian-rtl-considerations.md
7. responsive-design-specs.md
8. testing-strategy.md

Update Existing Files:
- docs/04-Flutter-Frontend/flutter-architecture.md
- docs/99-Quick-Reference/api-quick-reference.md
- docs/00-Project-Overview/ (add phase 5.2 report)
```

---

## âš¡ **Performance & Quality Standards**

### **UI/UX Performance Benchmarks:**
```yaml
Interaction Response:
- Widget drag start: < 16ms (60 FPS)
- Drop operation: < 50ms
- Property panel update: < 100ms
- Form save operation: < 2 seconds
- Canvas render: < 200ms for 50 widgets

Memory Usage:
- Base Form Builder: < 50MB
- Per widget in canvas: < 1MB
- Widget library cache: < 10MB
- Maximum form size: 100 widgets

Network Performance:
- Widget library load: < 500ms
- Form save: < 1 second
- Form load: < 800ms
- API timeout: 10 seconds
```

### **Code Quality Requirements:**
```yaml
Dart Code:
- Dartfmt compliance: 100%
- Linting rules: strict mode
- Persian comments: business logic ÙÙ‚Ø·
- Error handling: comprehensive
- Null safety: strict compliance

File Organization:
- Clean Architecture layers
- Single responsibility principle
- Persian naming for UI strings
- English naming for technical code
- Consistent import ordering
```

---

## ğŸ” **Testing & Validation Strategy**

### **UI Testing Requirements:**
```yaml
Widget Testing:
- ØªÙ…Ø§Ù… form builder widgets
- Drag & drop functionality
- Persian text rendering
- RTL layout correctness
- Error state displays

Integration Testing:
- Form creation flow
- Widget library interaction
- API integration flows
- State management correctness
- Navigation flows

Manual Testing:
- Persian keyboard input
- Touch interactions
- Responsive breakpoints
- Performance on low-end devices
- Persian content validation
```

### **API Testing Requirements:**
```yaml
Endpoint Testing:
- ØªÙ…Ø§Ù… CRUD operations
- Error response handling
- Persian character support
- JSON schema validation
- Permission checking

Database Integration:
- Foreign key constraints
- Transaction handling
- Persian data storage
- Performance with large datasets
- Concurrent access handling
```

---

## ğŸš« **Red Lines - Ø®Ø·ÙˆØ· Ù‚Ø±Ù…Ø² Ù…Ø±Ø­Ù„Ù‡ Ûµ.Û²**

### **Ù‡Ø±Ú¯Ø² Ø§ÛŒÙ† Ú©Ø§Ø±Ù‡Ø§ Ø±Ø§ Ù†Ú©Ù†ÛŒØ¯:**
```yaml
âŒ ØªØºÛŒÛŒØ± Ø¯Ø± Database Schema Ù…Ø±Ø­Ù„Ù‡ 5.1
âŒ Modification Ø¯Ø± PHP classes Ù…ÙˆØ¬ÙˆØ¯ (User.php, Form.php, etc)
âŒ ØªØºÛŒÛŒØ± Ø¯Ø± API endpoints ÙØ¹Ù„ÛŒ
âŒ Ø´Ú©Ø³ØªÙ† Clean Architecture patterns
âŒ ØªØºÛŒÛŒØ± theme ÛŒØ§ typography ÙØ¹Ù„ÛŒ
âŒ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† package Ù‡Ø§ÛŒ Ø³Ù†Ú¯ÛŒÙ†
âŒ ØªØºÛŒÛŒØ± Ø¯Ø± XAMPP configuration
âŒ Ø§ÛŒØ¬Ø§Ø¯ authentication system (Ù…Ø±Ø­Ù„Ù‡ Ø¢ÛŒÙ†Ø¯Ù‡!)
âŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ AI features (Ù…Ø±Ø­Ù„Ù‡ 5.3!)
```

### **Ù‚Ø§Ù†ÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ø§Ø¬Ø¨Ø§Ø±ÛŒ:**
```yaml
âœ… Ù‡Ø± component Ø¨Ø§ÛŒØ¯ Persian RTL Ø¨Ø§Ø´Ø¯
âœ… ØªÙ…Ø§Ù… API calls Ø¨Ø§ÛŒØ¯ error handling Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯
âœ… Provider pattern Ø¨Ø±Ø§ÛŒ state management
âœ… Material Design 3 consistency
âœ… Mobile-first responsive design
âœ… Clean Architecture compliance
âœ… Performance benchmarks Ø±Ø¹Ø§ÛŒØª Ø´ÙˆØ¯
âœ… Documentation Ù‡Ù…Ø²Ù…Ø§Ù† Ø¨Ø§ Ú©Ø¯
```

---

## ğŸ“Š **Success Criteria Ù…Ø±Ø­Ù„Ù‡ Ûµ.Û²**

### **Technical Success:**
```yaml
UI Implementation:
- Form Builder interface Ú©Ø§Ù…Ù„Ø§Ù‹ Ú©Ø§Ø±Ú©Ø±Ø¯
- Drag & Drop Ø¹Ù…Ù„ÛŒØ§ØªÛŒ
- Widget Library integration Ù…ÙˆÙÙ‚
- Persian RTL excellence
- Responsive design working

API Integration:
- 5 API endpoints Ø¬Ø¯ÛŒØ¯ Ø¹Ù…Ù„ÛŒØ§ØªÛŒ
- Flutter services integration Ù…ÙˆÙÙ‚
- Error handling Ø´Ø§Ù…Ù„ Persian messages
- Performance benchmarks achieved

State Management:
- Provider classes working smoothly
- Form data persistence
- Canvas state management
- Widget selection & properties
```

### **Business Success:**
```yaml
User Experience:
- Ú©Ø§Ø±Ø¨Ø± Ù‚Ø§Ø¯Ø± Ø¨Ù‡ Ø§ÛŒØ¬Ø§Ø¯ ÙØ±Ù… Ø³Ø§Ø¯Ù‡
- Widget library Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡
- Form preview functional
- Persian user interface excellent

Foundation:
- Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ AI integration (Phase 5.3)
- Scalable architecture Ø¨Ø±Ø§ÛŒ widgets Ø¨ÛŒØ´ØªØ±
- Documentation Ø¬Ø§Ù…Ø¹ Ø¨Ø±Ø§ÛŒ developers
- Testing strategy Ø§Ø¬Ø±Ø§ÛŒÛŒ
```

---

## ğŸ­ **Final Instructions - Ø¯Ø³ØªÙˆØ±Ø§Øª Ù†Ù‡Ø§ÛŒÛŒ**

### **Ù…Ø±Ø­Ù„Ù‡â€ŒØ¨Ù‡â€ŒÙ…Ø±Ø­Ù„Ù‡ Ø§Ø¬Ø±Ø§:**
```yaml
Step 1: API Endpoints creation (5 ÙØ§ÛŒÙ„ PHP)
Step 2: Flutter service layer implementation
Step 3: Provider classes development  
Step 4: Core UI components creation
Step 5: Form Builder main interface
Step 6: Drag & Drop functionality
Step 7: Navigation integration
Step 8: Persian RTL validation
Step 9: Responsive testing
Step 10: Documentation creation

âš ï¸ Ù‡Ø± Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø§ÛŒØ¯ test Ø´ÙˆØ¯ Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø¯Ø§Ù…Ù‡
âš ï¸ Persian RTL Ø¯Ø± Ù‡Ø± Ù…Ø±Ø­Ù„Ù‡ validation Ø´ÙˆØ¯
âš ï¸ Performance benchmarks Ø¯Ø± Ù‡Ø± Ù…Ø±Ø­Ù„Ù‡ check Ø´ÙˆØ¯
```

### **Quality Gates:**
```yaml
Gate 1: API endpoints (POST/GET tests successful)
Gate 2: Service layer (Flutter-PHP communication)
Gate 3: Provider integration (State management working)
Gate 4: Basic UI (Persian RTL rendering)
Gate 5: Drag & Drop (Core functionality)
Gate 6: Form Builder (Complete interface)
Gate 7: Integration (End-to-end workflow)
Gate 8: Performance (Benchmarks achieved)
Gate 9: Documentation (Complete coverage)
Gate 10: Final validation (User acceptance)
```

---

## ğŸŠ **Ready to Execute? - Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø¬Ø±Ø§ØŸ**

```yaml
âœ… Mission Clear: Form Builder UI Engine
âœ… Foundation Ready: Database + PHP Models Ø§Ø² 5.1  
âœ… Quality Standards: Ø³Ø®ØªÚ¯ÛŒØ±Ø§Ù†Ù‡ Ùˆ Ø¯Ù‚ÛŒÙ‚
âœ… Success Criteria: Ù‚Ø§Ø¨Ù„ Ø³Ù†Ø¬Ø´ Ùˆ ÙˆØ§Ø¶Ø­
âœ… Red Lines: Ù…Ø´Ø®Øµ Ùˆ ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø¹Ø¨ÙˆØ±
âœ… Architecture: Clean Ùˆ consistent
âœ… Persian RTL: Ø§ÙˆÙ„ÙˆÛŒØª Ø§ÙˆÙ„
âœ… Performance: Benchmarked Ùˆ optimized

ğŸš€ Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø±Ø­Ù„Ù‡ Ûµ.Û² Ø¢ØºØ§Ø² Ù…ÛŒâ€ŒØ´ÙˆØ¯...

âš ï¸ ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ: ÙÙ‚Ø· UI Engine - Ù†Ù‡ AIØŒ Ù†Ù‡ Authentication
âš ï¸ ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ: Persian RTL excellence Ø¯Ø± Ù‡Ù…Ù‡â€ŒØ¬Ø§
âš ï¸ ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ: Clean Architecture patterns Ø­ÙØ¸ Ø´ÙˆØ¯
âš ï¸ ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ: Database Schema Ù…Ø±Ø­Ù„Ù‡ 5.1 Ø¯Ø³Øª Ù†Ø®ÙˆØ±Ø¯
```

---

**ğŸ“… Created:** 2025-09-01  
**ğŸ‘¤ Author:** DataSave Project Manager - Ù…Ø¬ØªØ¨ÛŒ Ø­Ø³Ù†ÛŒ  
**ğŸ¯ Phase:** 5.2 Form Builder UI Engine - STRICT MODE  
**ğŸ”— Dependencies:** Phase 5.1 Database Evolution âœ… COMPLETED  
**ğŸ”’ Status:** READY FOR EXECUTION  

---

**Ù…Ù†ØªØ¸Ø± ØªØ£ÛŒÛŒØ¯ Ø´Ø±ÙˆØ¹ Ø¹Ù…Ù„ÛŒØ§Øª Form Builder UI Engine Ù‡Ø³ØªÛŒÙ…... â³**

## ğŸ“ **Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù†Ù‡Ø§ÛŒÛŒ: Ø§ÛŒØ¬Ø§Ø¯ docs/08-Form-Builder/**

```yaml
ğŸ“ docs/08-Form-Builder/
â”œâ”€â”€ 01-architecture/
â”‚   â”œâ”€â”€ form-builder-overview.md
â”‚   â”œâ”€â”€ ui-components-hierarchy.md
â”‚   â””â”€â”€ state-management-strategy.md
â”œâ”€â”€ 02-implementation/
â”‚   â”œâ”€â”€ drag-drop-system.md
â”‚   â”œâ”€â”€ widget-library-integration.md
â”‚   â””â”€â”€ canvas-management.md
â”œâ”€â”€ 03-api-integration/
â”‚   â”œâ”€â”€ form-crud-apis.md
â”‚   â”œâ”€â”€ widget-library-api.md
â”‚   â””â”€â”€ error-handling-strategy.md
â””â”€â”€ 04-user-experience/
    â”œâ”€â”€ persian-rtl-implementation.md
    â”œâ”€â”€ responsive-design-guide.md
    â””â”€â”€ accessibility-considerations.md

ğŸ¯ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ®ØµØµÛŒâ€ŒØªØ±ÛŒÙ† Ù…Ø³ØªÙ†Ø¯Ø³Ø§Ø²ÛŒ Form Builder! âœ¨
```